# msofficesvn コーディング規約 #
  * モジュール名

> MS Office アプリアドイン間で、スクリプトの内容が共通なモジュール名は

> cmn

> で始める。

  * 変数宣言を明示的に行なうこと。

> 各ファイルの冒頭には、必ず
```
Option Explicit
```
> を記述し、変数宣言を明示的に行うようにすること。

  * インデントは半角スペース2文字

  * 変数名はキャメルケースとする。

> プレフィックスが有る場合

> 小文字始まりのキャメルケースとする。例: prefixName

> プレフィックスが無い場合

> 大文字始まりのキャメルケースとする。例: NoPrefixName

> - よく使うプレフィックス:

> ans = メッセージボックスなどに対するユーザーの選択結果を保存する変数。

> b   = Boolean型フラグ

> msg = メッセージ文字列

> cap = コントロールなどのキャプション文字列

> akey = アクセスキー文字列

> fid = ボタンイメージID

> abs = 絶対値

> ref = 相対値

> スコープ

> g = グローバル変数

> m = モジュールスコープ変数

> - よく使う名前/サフィックス:

> Min, Max = 最小値と最大値

> Prev, Next, Curr = 前の値、次の値、現在値

> Tmp = 一時的な値

> Src, Dest = コピー元とコピー先


---

参考資料

http://msdn.microsoft.com/library/ja/default.asp?url=/library/ja/odeopg/html/deconnamingvariablesconstants.asp

http://local.joelonsoftware.com/mediawiki/index.php/Project_Aardvark_Functional_Specification_(Jp)
```
コーディング規約

Webサイトは負荷分散されるので、ASP.Netのセッションステートは(デフォルトの)メモリ中ではなく、SQL Serverに保持すべきだ。

同じものにはいつも同じ名前を使うようにする。たとえば、HTMLのINPUTタグの名前は、その値が格納される変数の名前に対応すべきで、それはまたSQLデータベースのカラム名に対応しているべきだ。

C#のコードではアプリケーションハンガリアン記法、別名Aardvarkウクレイニアン記法を使う。名前について強いコーディング規約があるのは正しいコードを書く助けになる。名前のバラエティが減るので、変数名を覚えるのも楽になる。また、変数名を考え出すためにあまり苦労しなくなる。名前の多くは予測可能になるからだ。

  変数名は小文字始まりのキャメルケースとする。例: prefixName

  よく使うプレフィックス:

    s = Unicode文字列
    ch = Unicode文字
    a = ANSI修飾子。as = ANSI文字列。ach = ANSI文字。
    utf8 = UFT8文字列
    c = 何かの個数。cb = バイト数(バッファサイズ)、cch = 文字列長
    ix = インデックス――データベースの主キー、ループインデックス、配列
        インデックス等
    rg = 配列(range:範囲)を表わし、通常プレフィックスとして使う。たとえ
        ばrgsは文字列配列
    f = ブール値のフラグで、値はtrueかfalse。もともとのアプリケーション
        ハンガリアンでは3値のフラグを許容しているが、我々は使わない。
    fl = ファイル
    fn = 関数(関数ポインタの変数名)
    path = パス。ファイルのフルパス名
    n = n値フラグ、あるいはenum
    b = バイト
    db = データベース
    dbl = 浮動小数点数(double)
    l = long。個数以外のlong型整数を表わすのに使う。
    x, y = ピクセル単位でのx, y座標
    d = 差(difference)。よく使うのはdxとdyで、幅と高さを表わす。また、
        ddt(timespan)やdix(配列のオフセット)等も使う。
    dt = 日付時刻(date/time、日付と時刻の両方を含む)
    rs = レコードセット
    sql = sql文
    tbl = データベーステーブル
    url = (部分ではなく)完全なURL
    urls = URLエンコードされた文字列
    html = HTMLを内容とする文字列で、そのままブラウザに渡せるもの
    p = ポインタを意味する修飾子。C/C++のポインタに使う。C#のコードでは
        必要とならない。
    o = オブジェクト

    新しいクラスを定義する場合、2-4文字のウクレイニアンプレフィックスを
    決めておき、クラス定義の頭に記述しておく。たとえばCSessionという名の
    クラスを定義するとき、"sess"をそのプレフィックスとして使う、という具
    合だ。

  よく使う名前/サフィックス:

    Min, Max = 最小値と最大値
    Prev, Next, Curr = 前の値、次の値、現在値
    Tmp = 一時的な値
    Src, Dest = コピー元とコピー先

  その型のローカル変数が1つしかない場合や特に重要な変数に対しては、しば
  しば名前の部分は省略される。たとえば1つの文字列型の引数を取る文字列処
  理関数を書く場合、その引数名はsと名付けられるだろう。引数で与えられた
  ファイルに文字列を書き込む関数であれば、引数名は(fl, s)になる。

  関数名は大文字始まりのキャメルケースとする。型変換を行う関数では
  TypeFromType(変換後の型From変換前の型)という形の名前にする。たとえば
  Utf8FromSはUnicodeをUTF-8に変換する関数である。

  クラス名はCかEで始める。(クラスオブジェクトの変数名は、クラスに対して
  決めたプレフィックスで始める。) Eはエンティティクラス(データベースのテ
  ーブルやビューの行に対応するクラス) を表わす。Cはそれ以外のクラスに使
  う。

  SQLテーブルは大文字始まりのキャメルケースを使い単数形の名前にする。た
  とえばCustomerとかPersonとし、CustomersとかPeopleとはしない。

  ほぼすべてのテーブルは、左端のカラムにautonumber(identity)を持たせて主
  キーにする。テーブル名Fooに対してixFooをその名前とする。たとえば
  Customerという名前のテーブルであれば、その最初のカラムにはixCustomerと
  いう名前の主キーがくる。このテーブルに対する外部キーの名前もixCustomer
  とする。ただし1つのテーブルに対する外部キーを複数持つテーブルについて
  は、修飾子を付加して、ixCustomerFirst、ixCustomerCurrent、
  ixCustomerReferrerなどとする。

  SQLテーブルでも、プログラムのコードと同じプレフィックスを使う。最もよ
  く使うのは、dt、f、n、c、ixだ。htmlやurlの方が適切な場合を別として、文
  字列は通常sをプレフィックスとする。長いテキスト(memo型)フィールドに対
  してはtxtも使う。データベーステーブル名はtbl、ビュー名はviewで始める。
  ストアドプロジージャは使わずに済ませたい。
```